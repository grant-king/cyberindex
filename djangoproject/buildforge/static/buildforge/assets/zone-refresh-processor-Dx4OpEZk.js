(function(){"use strict";self.onmessage=async n=>{const s=n.data,e=s[0],o=s[1],c=s[2],t=s[3],a=s[4],r=s[5],i=s[6],l=await f(e,o,c,t,a,r,i);postMessage(l)};async function f(n,s,e,o,c,t,a){const r=await _(Math.floor(n),Math.floor(s),Math.floor(e),o,c),i=h(r,t),l=d(i,a);return u(l,r)}function h(n,s){let e=[];for(const o of n){const c=s.findIndex(t=>t.pk===o.pk);e.push(c)}return e}function d(n,s){let e=[];for(const o of n)o<0?e.push("CREATENEW"):e.push(s[o].object.uuid);return e}function u(n,s){let e={};for(let o=0;o<n.length;o++){const c=n[o],t=s[o];c=="CREATENEW"?e[`${c}_${t.pk}`]={x:t.x,y:t.y,z:t.z,color:t.color}:e[`${c}`]={x:t.x,y:t.y,z:t.z}}return e}async function _(n,s,e,o,c){const t=new URLSearchParams({x:n,y:s,z:e}),a=await fetch(`${o}nearest/?${t}`,{method:"GET",headers:{"X-CSRFToken":c}});if(a.ok)return await a.json();console.error("failed to fetch nearest"),console.error(a)}})();
